<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" href="/../static/final_charge.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.1.8.js"></script>
    <meta charset="utf-8">
</head>

<body>

    <nav>
        <button class="section section1">helloworld</button>
        <button class="section section2">마이룸</button>
        <button class="section section3">구매</button>
        <button class="section section4">충전</button>
        <div class="section section5">
            <p>@@@님, 환영합니다!</p>
            <button id="logoutButton">로그아웃</button>
        </div>
    </nav>
    <div class="entire" id="117:681">
        <div class="orangebg_L" id="117:685">
            <div class="whitebg_L" id="117:687">
                <div class="whitebg_M">
                    <div class="charge" id="117:697">도토리충전</div>
                    <div class="orangebg_M" id="117:689">
                        <div class="box1" id="117:692">
                            <div class="divbox1" id="117:710">
                                    <div class="image_divbox1">
                                        <div class="box-radio-input">
                                            <input type="radio" name="cp_item" value="5000"><span>5,000원</span>
                                            <input type="radio" name="cp_item" value="10000"><span>10,000원</span>
                                            <input type="radio" name="cp_item" value="15000"><span>15,000원</span>
                                            <input type="radio" name="cp_item" value="20000"><span>20,000원</span>
                                            <input type="radio" name="cp_item" value="25000"><span>25,000원</span>
                                            <input type="radio" name="cp_item" value="30000"><span>30,000원</span>
                                            <input type="radio" name="cp_item" value="35000"><span>35,000원</span>
                                            <input type="radio" name="cp_item" value="40000"><span>40,000원</span>
                                            <input type="radio" name="cp_item" value="50000"><span>50,000원</span>
                                        </div>
                                    </div>
                                        <button class="button_divbox1" id="charge_kakao">구매</button>
                                <script>
                                    $('#charge_kakao').click(function () {
                                        var IMP = window.IMP;
                                        IMP.init("imp50046755");
                                        var money = $('input[name="cp_item"]:checked').val();
                                        console.log(money);
                                        IMP.request_pay({
                                            pg: "kcp",
                                            merchant_uid: 'merchant_' + new Date().getTime(),

                                            name: 'dotori',
                                            amount: money,
                                            buyer_email: 'cite9233@naver.com',
                                            buyer_name:'박선준',
                                            buyer_tel: '010-1234-5678',

                                        }, function (rsp) {
                                            console.log(rsp);
                                            if (rsp.success) {
                                                var msg = '결제가 완료되었습니다.';
                                                msg += '고유ID : ' + rsp.imp_uid;
                                                msg += '상점 거래ID : ' + rsp.merchant_uid;
                                                msg += '결제 금액 : ' + rsp.paid_amount;
                                                msg += '카드 승인번호 : ' + rsp.apply_num;
                                                $.ajax({
                                                    type: "GET",
                                                    url: "/final_charghdhe", //충전 금액값을 보낼 url 설정
                                                    data: {
                                                        "amount" : money
                                                    },
                                                });
                                            } else {
                                                var msg = '결제에 실패하였습니다.';
                                                msg += '에러내용 : ' + rsp.error_msg;
                                            }
                                            alert(msg);
                                        });
                                    });
                                </script>
                                        <div id="totalAmountOutput"></div>
                                        <script>
                                            var totalAmount = 0;

                                            $('#charge_kakao').click(function () {
                                                var selectedValue = $('input[name="cp_item"]:checked').val();
                                                if (selectedValue) {
                                                    totalAmount += parseInt(selectedValue);
                                                    $('#totalAmountOutput').text('누적된 금액: ' + totalAmount + '원');
                                                } else {
                                                    console.log('금액을 선택해주세요.');
                                                }
                                            });
                                        </script>
                            </div>
                            <div class="divbox2" id="117:710">
                                <div class="divbox2-1">충전이력</div>
                                <div class="divbox2-2">도토리 n개</div>
                                <span></span>
                                <div class="divbox2-3">xx년mm월dd일</div>
                            </div>
                            <div class="divbox3" id="117:710">
                                <div class="divbox3-1">도토리 조르기</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>

<!-- divbox1안에 검색창추가, 
도토리충전태그 분리안되도록수정, 
충전이력에 내용 띄어쓰기 추가하기, 
helloworld문구대신 로고이미지로 바꾸기, 
토초리 조르기에 내용 추가 -->