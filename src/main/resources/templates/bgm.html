<!DOCTYPE html><html lang="en"><head>  <meta charset="UTF-8">  <meta http-equiv="X-UA-Compatible" content="IE=edge">  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <link rel="preconnect" href="https://fonts.googleapis.com">  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>  <link href="https://fonts.googleapis.com/css2?family=Hi+Melody&family=Libre+Baskerville&family=Single+Day&family=Stylish&display=swap"        rel="stylesheet">  <title>Title</title>  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>  <style>    body {      font-family: 'Stylish', sans-serif;    }    #logout {      cursor: pointer;      background-color: #ffcc00;      height: 20px;      width: 90px;      text-align: center;      display: flex;      justify-content: center;      align-items: center;      border-radius: 15px;      position: absolute;      right: 0;      font-size: 11px;      color: #333;      border: none;      transition: background-color 0.3s ease;    }    #logout:hover {      background-color: #ff9900;      color: #fff;    }    #banner {      width: 100%;      height: 55px;      background-color: orange;      display: flex;      align-items: center;    }    .bannerbutton {      width: 12%;      background-color: #eaa013;      height: 100%;      align-items: center;      text-align: center;      display: flex;      justify-content: center;      border: solid white 3px;      margin-right: 5px;      font-size: 19px;      color: #ffffff;      text-shadow: -1px 0 #000, 0 1px #000, 1px 0 #000, 0 -1px #000;    }    #content {      display: flex;      justify-content: center;    }    #chargebox {      width: 1000px;      height: 600px;      background-color: #ffffff;      border: solid orange 3px;      display: flex;    }    .leftbanner {      width: 100px;      height: 40px;      background-color: #ffb571;      color: white;      border-radius: 2px;      text-align: center;      display: flex;      justify-content: center;      align-items: center;      margin-top: 4px;      border: solid #ff8d1c 1px;    }    #chargebox {      display: flex;      align-items: center;      justify-content: center;      border-radius: 8px;    }    #back {      position: relative;      height: 1000px;      background-image: url('https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fs4RlP%2FbtskQjr1WRj%2FVGu2w6gF1Pm7qMg7SCUZt1%2Fimg.png');      background-color: rgba(255, 255, 255, 0.1); /* adjust opacity here */    }    td {      border-left: solid #ff8d1c 1px;      padding-right: 5px;      padding-left: 5px;    }    #leftmusiclist > * {      font-size: 15px;    }    #leftmusiclist button {      font-size: 2px;    }  </style>  <script>    let belongingsList;    document.addEventListener('DOMContentLoaded', (event) => {      console.log(document.getElementById('belongingsData')!==null);      if(document.getElementById('belongingsData')!==null) {        ///여기는 모든창이 로드 되자마자 내가 가지고있는 것들이 미니룸 사진 위에 뜨게한거.        belongingsList = JSON.parse(document.getElementById('belongingsData').textContent);        console.log(belongingsList);//belonglist 텍스트를 json으로 바꿔서 객체 하나하나당 생성 가능.        if(belongingsList.productEntity!==null){          console.log( belongingsList.productEntity    );          console.log('여긴가');          for(let a of belongingsList){            console.log(a); // 출력: item1, item2, item3            let name = a.productEntity.pid;            $("#" + name).attr("disabled", true);            // $("#" + name).attr("disabled", true);}          }          // let name = belongingsList.productEntity.pid;          //          //          // $(".applybutton" + name).attr("disabled", true);          // // $("#" + name).attr("disabled", true);}      }else{        console.log("belongingsData는 null임");      }    }      $(document).on("click", ".musicname", function () {        var productId = $(this).attr('id');  // 클릭된 요소의 id 값을 가져옵니다.        var pid = productId.replace("musicname", "");  // "imagebox"를 제거합니다.        console.log(pid);        $.ajax({          url: "/musicapplyforplayinbuyingmusic",          type: "post",          data: {productId: pid, id: $("#idinput").val()},          success: (obj) => {//x눌러서 없어진 아이템들은 미니룸 화면 위에 없어져야 하니까 리다이렉트를 함            console.log(obj);            console.log(obj.item.productName);            console.log(obj.item.productFileName);            // console.log('이게 아이템'+obj.item.productId);            $("div[style='margin-left: 10px;margin-top: 10px']").text(obj.item.productName);            // Update the source of the audio            $(".haha source").attr("src", obj.item.productFileName);            $(".haha")[0].load();            // 이걸로 (바꿔줘)//                     <audio controls className="haha"//                            style="width: 250px; height: 40px; margin-top: 10px;margin-left: 10px">//                         <source th:src="@{${appliedmusic.productPath}}// " type='audio/mp3'/>          },          error: (err) => {            console.log(err);          }        });      });    });  </script></head><body><!--<p th:text = "${sellinglist}"></p>--><div id="banner">  <div id="mingyupush" style="width: 24%"></div>  <div  onclick="window.location.href='/home'" style="height: 100%">  <img id="logo" src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcdF9J4%2FbtskRufcTKP%2FmAHqe1WxB0eyLRqjxKR5kK%2Fimg.png"       style="height: 100%" alt="">  </div>  <div class="bannerbutton " id="myroom" onclick="window.location.href='/myPage'"  >마이룸</div>  <div class="bannerbutton" id="purchase" style="background-color: rgba(255,209,190,0.81)" onclick="window.location.href='/miniroom'">구매</div>  <div class="bannerbutton" id="charge" onclick="window.location.href='/cash'">충전</div>  <div class="logoutbox" style="position: absolute; top: 10px;right: 11px ">    <p style="margin-bottom: 3px;margin-top: 4px;font-size: 13px;            color: #5e5c5c;" th:text="${session.loginUser.userName} + '님 환영합니다'"></p>    <button id="logout" onclick="confirmLogout()" >      로그아웃    </button>  </div></div><p style="font-size: 4px"></p><div style="background-color: #ea8a8a;height: 4px; margin-top: 4px"></div><!--<p style="font-size: 40px"></p>--><!--여기부터 시작--><div style=" height: 800px" id="back">  <!--    한줄 띄고-->  <div style="height: 50px"></div>  <div id="content">    <div>      <div class="leftbanner"  id="leftsmallmyroom"  style="background-color: white;color: #c71a01;cursor: pointer;      font-weight: bold" onclick="window.location.href='/miniroom'">      마이룸      </div>      <div class="leftbanner"  id="leftsmallbgm"  style="font-weight: bold; cursor: pointer" onclick="window.location.href='/bgm'">      BGM      </div>    </div>    <!--        전체상자-->    <div id="chargebox" style="display: flex;">      <!--            왼쪽박스 아웃라인-->      <div style="width: 38%; height: 90%; background-color: #ffffff; display: flex; flex-direction: column; justify-content: center; align-items: center; margin-left: 8px; border: solid #ea6e23 2px">        <!--왼쪽큰박스중 첫번째박스-->        <div class="secondbox"             style="width: 94%; height: 80%; background-color: #ffffff; margin-right: 4px;display: flex;;  flex-direction: column; justify-content: center; align-items: center">          <div style="  width: 98%;height: 40%;background-color: #ffdbdb;display: flex;border: solid black 2px;margin-top: 5px">            <!--                    앨범커버들어있는곳-->            <div style="width: 40%;height: 100%;background-color: #ffdbdb; display: flex;justify-content: center;align-items: center">              <img style="width: 120px;height: 120px"                   src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdVjgLN%2FbtskRRI7oRu%2FZNekfirNZcJHBQXO3fkylK%2Fimg.jpg"                   alt="">            </div>            <!--                    대표음악, 플레이어가 있는곳-->            <div style="width: 60%;height: 100%;background-color: #ffdbdb; display: flex; flex-direction: column;justify-content: center">              <div style="margin-left: 10px; width: 120px; height: 30px; background-color: #ea6e23;text-align: center;display: flex;align-items: center;justify-content: center;border-radius: 4px;margin-bottom: 4px">                현재 재생중인음악              </div>              <div style="margin-left: 10px;margin-top: 10px">Bruno mars - Let it Be</div>              <audio controls class="haha"                     style="width: 170px; height: 40px; margin-top: 10px;margin-left: 10px">                <source src="https://docs.google.com/uc?export=open&id=158v03TRUrC9oZWwgenTRNWh_FO8i_QJg" type='audio/mp3'/>              </audio>            </div>          </div><!--구매버튼 비활성화하기 위해 막아놓는것.    -->          <div id="belongingsData" th:text="${representativemusic2}" style="display: none;"></div><!--          <table>--><!--            <tr th:each = "sellingmusic : ${belongingsList}">--><!--              &lt;!&ndash;            <tr>&ndash;&gt;--><!--              <td><img style="width: 20px;height: 20px"--><!--                       src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdVjgLN%2FbtskRRI7oRu%2FZNekfirNZcJHBQXO3fkylK%2Fimg.jpg"--><!--                       alt=""></td>--><!--              <td  class = "representm"  th:id="'representm'+${sellingmusic.pId}" style="width: 140px" th:text="${sellingmusic.productName}"> </td>--><!--              </td>--><!--              <td th:text="${#strings.substringBefore(sellingmusic.productName, '_')}"></td>-->          <!--                    음악리스트-->          <div id="leftmusiclist"               style="width: 100%;height: 50%;background-color: #ffffff;display: flex;justify-content: center;align-items: center;flex-direction: column; margin-top: 20px ">            <p style="margin-bottom: 30px; color: #c71a01">모든 음악의 가격은 도토리 10개로 동일합니다</p>            <table>              <tr   th:each = "sellingmusic : ${sellinglist}"  >                <td style="display: flex;justify-content: center;align-items: center"><img                        style="width: 20px;height: 20px"                        src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdVjgLN%2FbtskRRI7oRu%2FZNekfirNZcJHBQXO3fkylK%2Fimg.jpg"                        alt=""><!--                  <div style=" margin: 3px;  width: 40px;height: 20px;background-color: #ff5c43;border-radius: 2px;text-align: center; display: flex; align-items: center; align-content: center; justify-content: center">--><!--                    재생중--><!--                  </div>-->                </td>                <td class="musicname" th:id="'musicname'+ ${sellingmusic.pId}"                    th:text="${sellingmusic.productName}" ></td><!--                <input type="hidden" id="idinput" th:value="${havingmusiclist.User.Id}">--><!--                여기서부터 문제. productentity는 Id를 가질수가 없다.--><!--                자바스크립트에서 if로 해야함.-->                <td th:text="${#strings.substringBefore(sellingmusic.productName, '_')}"></td>                <td>                  <button class="applybutton" th:id="${sellingmusic.pId}"    onclick="purchase(event)"  >구매</button><!--                  <button class="applybutton" th:id="${sellingmusic.pId}"    th:onclick="purchase(${sellingmusic.pId})"  >구매</button>-->                </td>              </tr>            </table>          </div>        </div>        <!--왼쪽큰박스중 구매버튼잇는곳박스-->        <!--                아래 버튼 있는 박스--><!--        <div class="1"--><!--             style="width: 94%; height: 10%; margin-right: 7px;display: flex;padding: 10px; display: flex; justify-content: center ">--><!--          <button style="width: 100px; height: 30px">구매하기</button>--><!--        </div>기-->      </div>      <!--오른쪽박스-->      <div style="width: 48%; height: 90%; background-color: #ffffff; margin-right: 7px; display: flex; justify-content: center; flex-direction: column; align-items: center">        <div style="margin: 4px; margin-bottom: 10px">홈피적용음악 top5</div>        <!--    오른쪽박스 안 첫번째박스-->        <div style="width: 90%; height: 60%;  display: flex; align-items: center; flex-direction: column; ">          <div id="rightuppermusiclist"               style="width: 100%;height: 100%;display: flex;justify-content: center;align-items: center;flex-direction: column; border: solid #ea6e23 2px ">            <table>              <tr  th:each="top5 : ${top5productentity}">                <td th:style="'color:' + (${top5Stat.count} == 1 ? 'red' : 'blue')" th:text="${top5Stat.count} + ' 위 '"></td>                <td><img style="width: 30px;height: 30px"                         src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdVjgLN%2FbtskRRI7oRu%2FZNekfirNZcJHBQXO3fkylK%2Fimg.jpg"                         alt=""></td>                <td th:text="${top5.productName}">alicia Keys-No one</td>                <td th:text="${#strings.substringBefore(top5.productName, '_')}" >Alicia Keys</td>              </tr>            </table>          </div>        </div>        <div style="margin: 4px; margin-top: 10px; margin-bottom: 10px ">소유한음악</div>        <!--    오른쪽박스 안 두번째박스-->        <div style="border: solid orange 2px; width: 90%; height: 40%; background-color: #ffffff; display: flex; align-items: center; flex-direction: column; justify-content: center"><!--          <div style="margin-bottom: 10px; font-weight: bold; font-size: 17px; color: #ff0000 ">-이전-</div>--><!--          내가 가지고있는 음악-->          <table>            <tr th:each = "havingmusic : ${belongingsList}"><!--            <tr>-->              <td><img style="width: 20px;height: 20px"                       src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdVjgLN%2FbtskRRI7oRu%2FZNekfirNZcJHBQXO3fkylK%2Fimg.jpg"                       alt=""></td>              <td  class = "representm"  th:id="'representm'+${havingmusic.productEntity.pId}" style="width: 140px" th:text="${havingmusic.productEntity.productName}"> </td>              </td>              <td th:text="${#strings.substringBefore(havingmusic.productEntity.productName, '_')}"></td>            </tr>          </table><!--          <div style="margin-top: 10px; font-weight: bold; font-size: 17px; color: #ff0000 ">-이전-</div>-->        </div>      </div>    </div>  </div></div></div></body><script>  function purchase(event) {    var pId = event.target.id; // 클릭된 버튼의 ID    var confirmation = confirm("구매하시겠습니까?");    console.log(pId);    if (confirmation) {      $.ajax({        url:'/purchase',        type:'post',        data: {pId: pId},        success: (obj) => {          console.log(obj);          if(obj.item.msg === "complete") {            alert("구매가 완료되었습니다.");            location.reload();          } else {            alert("밤토리가 부족합니다.");            // location.href="/charge";          }        },        error: (err) => {          console.log(err);        }      });    } else {      console.log("구매가 취소되었습니다.");    }  }  function confirmLogout() {    if (confirm("정말 로그아웃 하시겠습니까?")) {      // "Yes"를 선택한 경우 로그아웃을 수행하는 URL로 리다이렉트      window.location.href = "/logout";    } else {      // "No"를 선택한 경우 아무 동작도 수행하지 않음    }  }</script></html>